<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="&amp;#108;&amp;#105;&amp;#110;&amp;#100;&amp;#97;&amp;#108;&amp;#x75;&amp;#111;&amp;#x38;&amp;#x33;&amp;#x40;&amp;#x31;&amp;#50;&amp;#54;&amp;#46;&amp;#x63;&amp;#111;&amp;#109;Lxl&amp;2309011 http:&#x2F;&#x2F;emrdev.or233.cn&#x2F;cn-sh6&#x2F;#&#x2F; &#x2F;opt&#x2F;cdh&#x2F;hadoop&#x2F;bin&#x2F;hadoop jar ~&#x2F;hadoop-mapredu">
<meta property="og:type" content="article">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/2020/10/15/hadoop%E6%93%8D%E4%BD%9C%E6%8C%87%E4%BB%A4/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="&amp;#108;&amp;#105;&amp;#110;&amp;#100;&amp;#97;&amp;#108;&amp;#x75;&amp;#111;&amp;#x38;&amp;#x33;&amp;#x40;&amp;#x31;&amp;#50;&amp;#54;&amp;#46;&amp;#x63;&amp;#111;&amp;#109;Lxl&amp;2309011 http:&#x2F;&#x2F;emrdev.or233.cn&#x2F;cn-sh6&#x2F;#&#x2F; &#x2F;opt&#x2F;cdh&#x2F;hadoop&#x2F;bin&#x2F;hadoop jar ~&#x2F;hadoop-mapredu">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-10-15T06:00:11.831Z">
<meta property="article:modified_time" content="2019-06-11T03:15:53.964Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-hadoop操作指令" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/10/15/hadoop%E6%93%8D%E4%BD%9C%E6%8C%87%E4%BB%A4/" class="article-date">
  <time datetime="2020-10-15T06:00:11.831Z" itemprop="datePublished">2020-10-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="mailto:&#108;&#105;&#110;&#100;&#97;&#108;&#x75;&#111;&#x38;&#x33;&#x40;&#x31;&#50;&#54;&#46;&#x63;&#111;&#109;">&#108;&#105;&#110;&#100;&#97;&#108;&#x75;&#111;&#x38;&#x33;&#x40;&#x31;&#50;&#54;&#46;&#x63;&#111;&#109;</a><br>Lxl&amp;2309011</p>
<p><a target="_blank" rel="noopener" href="http://emrdev.or233.cn/cn-sh6/#/">http://emrdev.or233.cn/cn-sh6/#/</a></p>
<p>/opt/cdh/hadoop/bin/hadoop jar ~/hadoop-mapreduce-examples-2.6.0.jar pi 30 1000</p>
<p>curl -sS -L -w ‘400’ -X GET –negotiate -u : ‘<a target="_blank" rel="noopener" href="http://sy-user1-test-0003.novalocal:50070/webhdfs/v1/opt/data/hadoop/tmp?op=GETFILESTATUS&#39;">http://sy-user1-test-0003.novalocal:50070/webhdfs/v1/opt/data/hadoop/tmp?op=GETFILESTATUS&#39;</a></p>
<p>curl –negotiate -u:anyUser “<a target="_blank" rel="noopener" href="http://sy-user1-test-0003.novalocal:50070/webhdfs/v1/tmp?op=OPEN">http://sy-user1-test-0003.novalocal:50070/webhdfs/v1/tmp?op=OPEN</a><br>“</p>
<h3 id="kerberos-debug"><a href="#kerberos-debug" class="headerlink" title="kerberos debug"></a>kerberos debug</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">export HADOOP_JAAS_DEBUG&#x3D;true</span><br><span class="line">log4j.logger.org.apache.hadoop.security&#x3D;DEBUG     </span><br><span class="line">export HADOOP_OPTS&#x3D;&quot;-Djava.net.preferIPv4Stack&#x3D;true -Dsun.security.krb5.debug&#x3D;true -Dsun.security.spnego.debug&quot;</span><br></pre></td></tr></table></figure>

<h3 id="make-a-directory"><a href="#make-a-directory" class="headerlink" title="make a directory"></a>make a directory</h3><p>curl -i -X PUT –negotiate -u:anyUser “<a target="_blank" rel="noopener" href="http://node101:50070/webhdfs/v1/tmp?op=MKDIRS&quot;">http://node101:50070/webhdfs/v1/tmp?op=MKDIRS&quot;</a><br>curl -i -X PUT –negotiate -u:anyUser “<a target="_blank" rel="noopener" href="http://node101:50070/webhdfs/v1/tmp?op=SETPERMISSION&amp;permission=777&quot;">http://node101:50070/webhdfs/v1/tmp?op=SETPERMISSION&amp;permission=777&quot;</a><br>curl -i -X PUT –negotiate -u:anyUser “<a target="_blank" rel="noopener" href="http://node101:50070/webhdfs/v1/tmp?op=SETOWNER&amp;owner=hdfs&amp;group=hadoop&quot;">http://node101:50070/webhdfs/v1/tmp?op=SETOWNER&amp;owner=hdfs&amp;group=hadoop&quot;</a></p>
<h3 id="hadoop-proxy-user"><a href="#hadoop-proxy-user" class="headerlink" title="hadoop proxy user"></a>hadoop proxy user</h3><p>core-site.xml<br>user hdfs模仿host1, host2上的组group1，group2里的用户user1，ly</p>
<pre><code>   &lt;property&gt;
     &lt;name&gt;hadoop.proxyuser.hdfs.hosts&lt;/name&gt;
     &lt;value&gt;host1,host2&lt;/value&gt;
   &lt;/property&gt;
   &lt;property&gt;
     &lt;name&gt;hadoop.proxyuser.hdfs.groups&lt;/name&gt;
     &lt;value&gt;group1,group2&lt;/value&gt;
   &lt;/property&gt;
   &lt;property&gt;
     &lt;name&gt;hadoop.proxyuser.hdfs.users&lt;/name&gt;
     &lt;value&gt;user1,ly&lt;/value&gt;
   &lt;/property&gt;</code></pre>
<p>切换到hdfs，声明要代理的用户为user1<br>hdfs@host1:~$ export HADOOP_PROXY_USER=ly </p>
<p>提交作业<br>hdfs@host1:~$ hadoop jar /home/ly/wordcount.jar /user/ly/input/input.txt /user/ly/output22</p>
<p>hdfs提交用户ly的hadoop命令时，切换到了该用户</p>
<p>[<a target="_blank" rel="noopener" href="https://blog.csdn.net/u012948976/article/details/49904675]">https://blog.csdn.net/u012948976/article/details/49904675]</a></p>
<h3 id="查询监控信息"><a href="#查询监控信息" class="headerlink" title="查询监控信息"></a>查询监控信息</h3><p>hadoop kerbname<br>hdfs groups<br>curl -s -k <a target="_blank" rel="noopener" href="http://node101:50070/jmx?qry=Hadoop:service=NameNode,name=FSNamesystem">http://node101:50070/jmx?qry=Hadoop:service=NameNode,name=FSNamesystem</a></p>
<p>curl –negotiate-u： -s -k <a target="_blank" rel="noopener" href="http://sy-user1-test-0004.novalocal:50070/jmx?qry=Hadoop:service=NameNode,name=FSNamesystem">http://sy-user1-test-0004.novalocal:50070/jmx?qry=Hadoop:service=NameNode,name=FSNamesystem</a></p>
<pre><code>&#123;
  &quot;beans&quot; : [ &#123;
    &quot;name&quot; : &quot;Hadoop:service=NameNode,name=FSNamesystem&quot;,
    &quot;modelerType&quot; : &quot;FSNamesystem&quot;,
    &quot;tag.Context&quot; : &quot;dfs&quot;,
    &quot;tag.HAState&quot; : &quot;active&quot;,
    &quot;tag.Hostname&quot; : &quot;node101&quot;,
    &quot;BlocksTotal&quot; : 0,
    &quot;MissingBlocks&quot; : 0,
    &quot;MissingReplOneBlocks&quot; : 0,
    &quot;ExpiredHeartbeats&quot; : 0,
    &quot;TransactionsSinceLastCheckpoint&quot; : 40,
    &quot;TransactionsSinceLastLogRoll&quot; : 40,
    &quot;LastWrittenTransactionId&quot; : 40,
    &quot;LastCheckpointTime&quot; : 1558404327000,
    &quot;UnderReplicatedBlocks&quot; : 0,
    &quot;CorruptBlocks&quot; : 0,
    &quot;CapacityTotal&quot; : 28968488960,
    &quot;CapacityTotalGB&quot; : 27.0,
    &quot;CapacityUsed&quot; : 8192,
    &quot;CapacityUsedGB&quot; : 0.0,
    &quot;CapacityRemaining&quot; : 15296614400,
    &quot;CapacityRemainingGB&quot; : 14.0,
    &quot;CapacityUsedNonDFS&quot; : 13671866368,
    &quot;TotalLoad&quot; : 1,
    &quot;SnapshottableDirectories&quot; : 0,
    &quot;Snapshots&quot; : 0,
    &quot;NumEncryptionZones&quot; : 0,
    &quot;LockQueueLength&quot; : 0,
    &quot;NumFilesUnderConstruction&quot; : 0,
    &quot;NumActiveClients&quot; : 0,
    &quot;FilesTotal&quot; : 15,
    &quot;PendingReplicationBlocks&quot; : 0,
    &quot;ScheduledReplicationBlocks&quot; : 0,
    &quot;PendingDeletionBlocks&quot; : 0,
    &quot;ExcessBlocks&quot; : 0,
    &quot;PostponedMisreplicatedBlocks&quot; : 0,
    &quot;PendingDataNodeMessageCount&quot; : 0,
    &quot;MillisSinceLastLoadedEdits&quot; : 0,
    &quot;BlockCapacity&quot; : 2097152,
    &quot;StaleDataNodes&quot; : 0,
    &quot;TotalFiles&quot; : 15
  &#125; ]

···</code></pre>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2020/10/15/hadoop%E6%93%8D%E4%BD%9C%E6%8C%87%E4%BB%A4/" data-id="ckgaezfz50000qwvvczy50dxb" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2020/10/15/article-title/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">article title</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/10/15/hadoop%E6%93%8D%E4%BD%9C%E6%8C%87%E4%BB%A4/">(no title)</a>
          </li>
        
          <li>
            <a href="/2020/10/15/article-title/">article title</a>
          </li>
        
          <li>
            <a href="/2020/10/15/hello-world/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>